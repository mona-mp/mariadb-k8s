# variables:
#   IMAGE_NAME: monamp10/user-management
#   IMAGE_TAG: 1.0

stages:
  - test1
  - test2


run_test:
  stage: test2
  image: golang:1.17
  script:
    - go test -v
    - go build main.go



build_image:
  stage: test1
  before_script:
    - docker login -u "monamp10" -p "ArvanCloud1qaz!QAZ"
  script:
    - docker build -t monamp10/user-management:1.0 .
    - docker push monamp10/user-management:1.0